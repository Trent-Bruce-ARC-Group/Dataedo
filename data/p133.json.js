window.repositoryObject = {"parameters_custom_fields":[],"object_id":"p133","name":"admin.sp_load_jobready_stage_table","subtype":"PROCEDURE","is_user_defined":false,"description":null,"summary":[{"field":"Documentation","value":{"_type":"link","name":"ARC Data Warehouse","id":"d6"}},{"field":"Schema","value":"admin"},{"field":"Name","value":"sp_load_jobready_stage_table"},{"field":"Type","value":"Procedure"}],"script":"--SET QUOTED_IDENTIFIER ON|OFF\r\n--SET ANSI_NULLS ON|OFF\r\n--GO\r\nCREATE PROCEDURE [admin].[sp_load_jobready_stage_table]\r\nAS\r\nBEGIN\r\n\tDECLARE @nID INT, @cSQL VARCHAR(MAX);\r\n\tDECLARE cur_load_jobready_table CURSOR\r\n\tFOR\r\n\t\tSELECT id FROM stg.t_mysql_raw_backup\r\n\tOPEN cur_load_jobready_table\r\n\tFETCH NEXT FROM cur_load_jobready_table INTO @nId\r\n\tWHILE @@FETCH_STATUS = 0\r\n\tBEGIN\r\n\t\tSELECT @cSQL = 'INSERT INTO stg.' + \r\n\t\tSUBSTRING(row_content,14,CHARINDEX('`',row_content, 14) - 14) + ' ' +  \r\n\t\tSUBSTRING(row_content, CHARINDEX('`',row_content, 14) + 1 , LEN(row_content) - 15) \r\n\t\tFROM stg.t_mysql_raw_backup\r\n\t\tWHERE id = @nID\r\n\t\t\r\n\t\tEXEC (@cSQL)\r\n\r\n\t\tSET @cSQL = ''\r\n\r\n\tFETCH NEXT FROM cur_load_jobready_table INTO @nID\r\n\tEND \r\n\tCLOSE cur_load_jobready_table\r\n\tDEALLOCATE cur_load_jobready_table\r\nEND","parameters":[],"dependencies":null,"imported_at":"2021-08-04 00:01"};